SELECT PCATEGORY, AVG(HEAD_COUNT) AS AVERAGE_HEAD_COUNT
FROM (
    SELECT P.PCATEGORY, COUNT(R.ENGINEERID) AS HEAD_COUNT
    FROM PROJECT P
    JOIN RESEARCH R ON P.PROJECTID = R.PROJECTID
    GROUP BY P.PCATEGORY, P.PROJECTID
)
GROUP BY PCATEGORY
ORDER BY PCATEGORY DESC;